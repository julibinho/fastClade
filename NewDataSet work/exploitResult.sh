#!/bin/bash

cSeed="/home/martin/projet_3I013/partC++/split/seed/seedNamePF04857";
cSeq="/home/martin/projet_3I013/partC++/split/test/allseqNamePF04857";
testfile="/home/martin/projet_3I013/partC++/toUploadHitHub/result2.txt";


checkSeed=false
checkSeq=false

expected=`cat $cSeq | wc -l` #nombre de TP attendu si accurate a 100%
TP=0;
TN=0;
FP=0;
FN=0;

while IFS= read -r var
do
	checkSeed=false
	checkSeq=false
	currentSeq=`echo $var | awk '{print $1}'`   #check le nom de la seq actuelle
	currentSeed=`echo $var | awk '{print $3}'`  #check le nom du seed associé
	
	for i in `cat $cSeed | tr -d ">"`:
		#echo $i $currentSeed
		do if [ "$i" == "$currentSeed" ] ; then checkSeed=true; fi #si la seed associé fait parti du fichier de seed, alors la reconnaissance est faite
	done;
	
	for i in `cat $cSeq | tr -d ">"`:
		do if [ "$i" == "$currentSeq" ] ; then checkSeq=true;fi #si la seq fait parti du machin du modèle, alors c'est bon
	done ;


	if [ "$checkSeq" == true ] && [ "$checkSeed" == true ] ; then TP=$(($TP+1)) ; fi
	if [ "$checkSeq" == false ] && [ "$checkSeed" == true ] ; then FP=$(($FP+1)) ; fi
	if [ "$checkSeq" == true ] && [ "$checkSeed" == false ] ; then FN=$(($FN+1)) ; fi
	if [ "$checkSeq" == false ] && [ "$checkSeed" == false ] ; then TN=$(($TN+1)) ; fi

done < "$testfile"
	total=$(($TP+$TN+$FP+$FN))
	echo True Positif : $TP sur $expected soit `awk -v TP="$TP" -v expected="$expected" 'BEGIN{print (TP/expected)*100}'`%;
	echo True negatif : $TN sur $(($total-$expected)) soit `awk -v TN="$TN" -v total="$total" -v expected="$expected" 'BEGIN{print (TN/ (total-expected))*100}'`%;
	echo False Positive : $FP sur $(($total-$expected)) soit `awk -v FP="$FP" -v total="$total" -v expected="$expected" 'BEGIN{print (FP/(total-expected))*100}'`%;
	echo False Negative : $FN sur $expected soit `awk -v FN="$FN" -v expected="$expected" 'BEGIN{print (FN/expected)*100}'`%;
	echo ###;
	echo Precision : `awk -v TP="$TP" -v FP="$FP" -v FN="$FN" -v TN="$TN" 'BEGIN{print ((TP)/(TP+FP))*100}'`% 
	echo Recall : `awk -v TP="$TP" -v FP="$FP" -v FN="$FN" -v TN="$TN" 'BEGIN{print ((TP)/(TP+FN))*100}'`% 
	echo Accuracy : `awk -v TP="$TP" -v FP="$FP" -v FN="$FN" -v TN="$TN" 'BEGIN{print ((TP+TN)/(TP+TN+FP+FN))*100}'`%   
	echo FScore : `awk -v TP="$TP" -v FP="$FP" -v FN="$FN" -v TN="$TN" 'BEGIN{print ((( 2* ((TP)/(TP+FN)) * ((TP)/(TP+FP))) /(((TP)/(TP+FN))+((TP)/(TP+FP)))))*100}'`%	 























